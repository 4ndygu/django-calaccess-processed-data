INSERT INTO calaccess_processed_monetarycontribution (
    filing_id,
    line_item,
    date_received,
    date_received_thru,
    transaction_type,
    transaction_id,
    memo_reference_number,
    contributor_code,
    contributor_committee_id,
    contributor_title,
    contributor_lastname,
    contributor_firstname,
    contributor_name_suffix,
    contributor_city,
    contributor_state,
    contributor_zip,
    contributor_employer,
    contributor_occupation,
    contributor_is_self_employed,
    intermediary_committee_id,
    intermediary_title,
    intermediary_lastname,
    intermediary_firstname,
    intermediary_name_suffix,
    intermediary_city,
    intermediary_state,
    intermediary_zip,
    intermediary_employer,
    intermediary_occupation,
    intermediary_is_self_employed,
    amount,
    cumulative_ytd_amount,
    cumulative_election_amount
)
SELECT 
    items.filing_id,
    items.line_item,
    items.date_received,
    items.date_received_thru,
    items.transaction_type,
    items.transaction_id,
    items.memo_reference_number,
    items.contributor_code,
    items.contributor_committee_id,
    items.contributor_title,
    items.contributor_lastname,
    items.contributor_firstname,
    items.contributor_name_suffix,
    items.contributor_city,
    items.contributor_state,
    items.contributor_zip,
    items.contributor_employer,
    items.contributor_occupation,
    items.contributor_is_self_employed,
    items.intermediary_committee_id,
    items.intermediary_title,
    items.intermediary_lastname,
    items.intermediary_firstname,
    items.intermediary_name_suffix,
    items.intermediary_city,
    items.intermediary_state,
    items.intermediary_zip,
    items.intermediary_employer,
    items.intermediary_occupation,
    items.intermediary_is_self_employed,
    items.amount,
    items.cumulative_ytd_amount,
    items.cumulative_election_amount
FROM calaccess_processed_monetarycontributionversion items
JOIN calaccess_processed_form460 filing_version
ON items.filing_id = filing_version.filing_id
AND items.amend_id = filing_version.amendment_count;